function drawMeter(canvas, amount, progressAmount, meterType) {
    let ctx = canvas.getContext("2d");

    let dp = window.devicePixelRatio || 1;
    let cw = canvas.clientWidth * dp;
    let ch = canvas.clientHeight * dp;

    if (canvas.width == cw && canvas.height == ch) {
        ctx.clearRect(0, 0, cw, ch);
    } else {
        canvas.width = cw;
        canvas.height = ch;
    }

    let lineWidth = 60;

    let originX = canvas.width / 2;
    let originY = canvas.height / 2;

    ctx.beginPath();
    ctx.strokeStyle = backgroundColor;
    ctx.lineWidth = lineWidth;

    ctx.arc(originX, originY, outerRadius, alpha0, alpha1);

    ctx.shadowBlur = 20;
    ctx.shadowColor = "black";

    ctx.stroke();

    let progressColor =
        meterType === "dl"
            ? generateGradientWrapper(canvas, dlColorStops)
            : generateGradientWrapper(canvas, ulColorStops);

    ctx.beginPath();
    ctx.strokeStyle = progressColor;
    ctx.lineWidth = lineWidth;

    let t = normalize(amount, meterMin, meterMax);
    let alpha2 = clamp(lerp(alpha0, alpha1, t), alpha0, alpha1);

    ctx.arc(originX, originY, outerRadius, alpha0, alpha2);
    ctx.shadowBlur = 20;
    ctx.shadowColor = "red";
    ctx.stroke();

    let innerRadius = outerRadius / 1.2;

    let progressGlowColor =
        meterType === "dl"
            ? generateGradientWrapper(canvas, dlColorStops.map(makeGlowColor))
            : generateGradientWrapper(canvas, ulColorStops.map(makeGlowColor));

    ctx.beginPath();
    ctx.strokeStyle = progressGlowColor;
    ctx.lineWidth = lineWidth;
    ctx.arc(originX, originY, innerRadius, alpha0, alpha2, false);
    ctx.stroke();

    ctx.shadowBlur = 0;

    let barWidth = outerRadius * 1.5;
    let barHeight = lineWidth / 4;

    let x = (canvas.width - barWidth) / 2;
    let y = (canvas.height - barHeight) / 2 + outerRadius;

    ctx.fillStyle = backgroundColor;
    ctx.fillRect(x, y, barWidth, barHeight);
    ctx.stroke();

    if (typeof progressAmount !== "undefined") {
        ctx.shadowBlur = 0;
        ctx.fillStyle = progressBarColor;

        ctx.fillRect(x, y, barWidth * progressAmount, barHeight);
        ctx.stroke();
    }
}